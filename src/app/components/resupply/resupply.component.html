<igb-navbar></igb-navbar>

<div class="container content">
    <div id="modal_process" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    <div class="progress">
                        <div class="progress-bar progress-bar-info progress-bar-striped active" role="progressbar" aria-valuenow="100" aria-valuemin="0"
                            aria-valuemax="100" style="width: 100%">
                            <span class="sr-only">Estamos procesando la solicitud</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <form #resupplyForm="ngForm" (ngSubmit)="stockTransfer(false)">
        <div id="modalUbicacion" class="modal fade" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-sm" role="document">
                <div class="modal-content" *ngIf="locationFrom">
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-xs-12 margin-bottom-10">
                                <label>Ubicación</label>
                                <input type="text" class="form-control" [(ngModel)]="locationConfirm" autocomplete="off" name="locationConfirm" autocorrect="off"
                                    autocapitalize="none">
                            </div>
                            <div class="col-xs-12 margin-bottom-10">
                                <label>Cantidad ({{locationFrom[2]}})</label>
                                <input type="text" class="form-control" [(ngModel)]="quantityConfirm" autocomplete="off" name="quantityConfirm" autocorrect="off"
                                    autocapitalize="none">
                            </div>
                            <div class="row">
                                <div class="col-xs-12">
                                    <div class="alert alert-danger" role="alert" *ngIf="message != null && message.length > 0">
                                        <p>{{message}}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Aplicar</button>
                    </div>
                </div>
            </div>
        </div>
    </form>

    <div id="modalConfiguracion" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Limite ubicaciones</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-xs-12 col-md-6">
                            <!--<div class="row">
                                <div class="col-xs-12 margin-bottom-10">
                                    <div class="input-group">
                                        <input type="text" class="form-control" placeholder="Buscar">
                                        <span class="input-group-btn">
                                            <button class="btn btn-default" type="button">
                                                <span class="glyphicon glyphicon-search"></span>
                                            </button>
                                        </span>
                                    </div>
                                </div>
                            </div>-->
                            <div class="row">
                                <div class="col-xs-12">
                                    <div class="hidden-md hidden-lg">
                                        <select id="limit" class="form-control" [(ngModel)]="limitSelect.code" name="code" (change)="changeLimitSelect()">
                                            <option style="display:none" disabled value="">Selecciona un limite</option>
                                            <option *ngFor="let limit of limits" value="{{limit.code}}">{{limit.ubicacion}} - {{limit.item}}</option>
                                        </select>
                                        <hr/>
                                    </div>
                                    <div class="hidden-xs hidden-sm" style="max-height: 222px; overflow-y: auto">
                                        <table class="table table-bordered table-striped">
                                            <tr class="pointer-cursor" [ngClass]="{'location-limit-active': limitSelect.code === limit.code, 'location-limit': limitSelect.code !== limit.code}"
                                                *ngFor="let limit of limits" (click)="selectLimit(limit)">
                                                <td>{{limit.ubicacion}}</td>
                                                <td>{{limit.item}}</td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-12 col-md-6">
                            <form #LimitForm="ngForm" (ngSubmit)="saveLocationLimit()">
                                <div class="row">
                                    <div class="col-xs-12 margin-bottom-10">
                                        <label>Ubicación</label>
                                        <input type="text" class="form-control" [(ngModel)]="limitSelect.ubicacion" autocomplete="off" name="ubicacion" autocorrect="off"
                                            autocapitalize="none">
                                    </div>
                                    <div class="col-xs-12 margin-bottom-10">
                                        <label>Ítem</label>
                                        <input type="text" class="form-control" [(ngModel)]="limitSelect.item" autocomplete="off" name="item" autocorrect="off" autocapitalize="none">
                                    </div>
                                    <div class="col-xs-12 margin-bottom-10">
                                        <label>Cantidad minima</label>
                                        <input type="text" class="form-control" [(ngModel)]="limitSelect.cantMinima" autocomplete="off" name="cantMinima" autocorrect="off"
                                            autocapitalize="none">
                                    </div>
                                    <div class="col-xs-12 margin-bottom-10">
                                        <label>Cantidad maxima</label>
                                        <input type="text" class="form-control" [(ngModel)]="limitSelect.cantMaxima" autocomplete="off" name="cantMaxima" autocorrect="off"
                                            autocapitalize="none">
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-default" (click)="clean()" *ngIf="limitSelect && limitSelect.ubicacion !== null && limitSelect.ubicacion.length > 0">Cancelar</button>
                    <button type="button" class="btn btn-default" (click)="deleteLocationLimit()" *ngIf="limitSelect && limitSelect.code !== null && limitSelect.code.length > 0">Eliminar</button>
                    <button type="button" class="btn btn-primary" (click)="saveLocationLimit()">Guardar</button>
                </div>
            </div>
        </div>
    </div>

    <div id="modalAdvertencia" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-sm" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Advertencia</h4>
                </div>
                <div class="modal-body">
                    <p>La cantidad ingresada supera a la máxima que se puede tener en la ubicación</p>
                    <p class="center-component">¿Desea continuar?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                    <button (click)="stockTransfer(true)" type="button" class="btn btn-primary">Continuar</button>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-xs-12 col-md-4 col-md-offset-4 margin-bottom-10">
            <div class="row">
                <div class="col-xs-6">
                    <button type="button" class="btn btn-default" (click)="goToPass(null, null, true)" *ngIf="pass > 1">
                        <span class="glyphicon glyphicon-arrow-left"></span>
                        Atras
                    </button>
                </div>
                <div class="col-xs-6 right-component pointer-cursor" *ngIf="admin">
                    <span class="glyphicon glyphicon-cog configuration-button" (click)="listLocationLimits()"></span>
                </div>
            </div>
        </div>
    </div>
    <div class="row" *ngIf="message != null && message.length > 0">
        <div class="col-xs-12 margin-bottom-10">
            <div class="alert alert-danger" role="alert">
                <p>{{message}}</p>
            </div>
        </div>
    </div>
    <div class="row" *ngIf="pass === 1">
        <div class="col-xs-12 col-md-4 col-md-offset-4">
            <table class="table table-bordered table-striped">
                <tr>
                    <th>#</th>
                    <th>Ubicación</th>
                    <th></th>
                </tr>
                <tr *ngFor="let location of locationsResupply; let i = index">
                    <td>{{i + 1}}</td>
                    <td>{{location[1]}}</td>
                    <td class="pointer-cursor" (click)="goToPass(location, null, false)">
                        <span class="glyphicon glyphicon-chevron-right"></span>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <div class="row" *ngIf="pass === 2">
        <div class="col-xs-12 col-md-4 col-md-offset-4">
            <table class="table table-bordered table-striped">
                <tr>
                    <th>#</th>
                    <th>Referencia</th>
                    <th></th>
                </tr>
                <tr *ngFor="let item of items; let i = index">
                    <td>{{i + 1}}</td>
                    <td>{{item[0]}}
                        <span class="badge badge-red">{{item[1]}}</span>
                    </td>
                    <td class="pointer-cursor" (click)="goToPass(null, item, false)">
                        <span class="glyphicon glyphicon-chevron-right"></span>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <div class="row" *ngIf="pass === 3">
        <div class="col-xs-12 col-md-4 col-md-offset-4 margin-bottom-10 right-component">
            <b>Cantidad necesaria: {{item[1]}}</b>
        </div>
        <div class="col-xs-12 col-md-4 col-md-offset-4">
            <table class="table table-bordered table-striped">
                <tr>
                    <th>#</th>
                    <th>Ubicación</th>
                    <th></th>
                </tr>
                <tr *ngFor="let storage of locationsStorage; let i = index">
                    <td>{{i + 1}}</td>
                    <td>{{storage[1]}}
                        <span class="badge">{{storage[2]}}</span>
                    </td>
                    <td class="pointer-cursor" (click)="useLocation(storage)">
                        <span class="glyphicon glyphicon-ok"></span>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <div class="row">
        <div class="col-xs-12">
            <div class="alert alert-danger" role="alert" *ngIf="message != null && message.length > 0">
                <p>{{message}}</p>
            </div>
        </div>
    </div>
</div>